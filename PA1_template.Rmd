---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
if (!file.exists("activity.csv")) unzip("activity.zip")
activity <- read.csv("activity.csv")
activity$interval <- as.factor(activity$interval)

## What is mean total number of steps taken per day?
total.steps.per.day <- with(activity, tapply(steps, date, sum, na.rm=TRUE)
hist(total.steps.per.day)
print(paste("Mean: ",mean(total.steps.per.day)))
print(paste("Median: ",median(total.steps.per.day)))

## What is the average daily activity pattern?
mean.per.interval <- with(activity, tapply(steps, interval, mean, na.rm=TRUE))
plot(names(mean.per.interval), mean.per.interval, type="l")
print(paste("Interval of Most activity: ", names(mean.per.interval[max(mean.per.interval)])))


## Imputing missing values
print(paste("Number of missing values",sum(is.`na(activity$steps))))
# Replace NAs with mean for that interval
activity2 <- activity
activity2$steps[is.na(activity2$steps)] <- mean.per.interval[activity2.interval[is.na(activity2$steps)]]
total.steps.per.day2 <- with(activity2, tapply(steps, date, sum))
hist(total.steps.per.day2)
print(paste("Mean: ", mean(total.steps.per.day)))
print(paste("Median: ", median(total.steps.per.day)))
print("Inserting the missing values changed the mean and the median")
print("Both the Mean and the Median increased with inserted missing values")


## Are there differences in activity patterns between weekdays and weekends?
